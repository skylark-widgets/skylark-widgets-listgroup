{"version":3,"sources":["carousel.js"],"names":["define","langx","browser","eventer","$","elmx","plugins","groups","Group","Indicators","EffectSlide","effects","slide","Carousel","inherit","klassName","pluginName","options","classes","display","single","leftEdge","rightEdge","cycling","controls","cycle","interval","pause","wrap","keyboard","selectors","toggle","prev","next","close","cycleStop","indicators","indicator","template","indexAttrName","itemsContainer","indicatorsContainer","item","selector","base","data","effect","startIndex","rotate","coverflow","onjumped","onjumping","_construct","elm","prototype","call","this","selectable","multiSelect","_$elm","_$itemsContainer","find","$indicators","length","_indicators","mixin","carousel","active","setActiveIndicator","paused","moving","$active","on","proxy","keydown","document","documentElement","e","stop","cycled","_effect","items","addItems","jump","test","target","tagName","which","preventDefault","isDefined","_velm","addClass","removeClass","clearInterval","setInterval","getItemForDirection","direction","activeIndex","getItemIndex","_$items","itemIndex","eq","pos","that","activeItem","getActiveItem","one","pausing","isUndefined","index","getItemsCount","i","addItem","resetItems","itemData","itemHtml","renderItemHtml","baseClass","$item","append","addIndicator","register"],"mappings":"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","file":"../carousel.js","sourcesContent":[" define([\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-browser\",\r\n  \"skylark-domx-eventer\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-domx-velm\",\r\n  \"skylark-domx-plugins-base\",\r\n  \"./groups\",\r\n  \"./group\",\r\n  \"./_carousel/indicators\",\r\n  \"./_carousel/effect_slide\"\r\n],function(langx,browser,eventer,$,elmx,plugins,groups,Group,Indicators,EffectSlide){\r\n  'use strict'\r\n\r\n  var effects = {\r\n    \"slide\" : EffectSlide\r\n  };\r\n \r\n  var Carousel = Group.inherit({\r\n    klassName : \"Carousel\",\r\n\r\n    pluginName : \"lark.groups.carousel\",\r\n\r\n        options : {\r\n            classes : {\r\n             // The class to add when the carousel is visible:\r\n              display: 'display',\r\n              // The class to add when the carousel only displays one item:\r\n              single: 'single',\r\n              // The class to add when the left edge has been reached:\r\n              leftEdge: 'left',\r\n              // The class to add when the right edge has been reached:\r\n              rightEdge: 'right',\r\n              // The class to add when the automatic slideshow is active:\r\n              cycling: 'cycling',\r\n\r\n              // The class to add when the carousel controls are visible:\r\n              controls: 'controls',\r\n            },\r\n\r\n            cycle : {\r\n              // [milliseconds]\r\n              // If a positive number, Carousel will automatically advance to next item after that number of milliseconds\r\n              interval: 5000,\r\n\r\n              pause: 'hover'        \r\n            },\r\n\r\n            wrap: true,\r\n            keyboard: true,\r\n\r\n            controls : {\r\n              selectors : {\r\n               // The class for the \"toggle\" control:\r\n                toggle: '.toggle',\r\n                // The class for the \"prev\" control:\r\n                prev: '.prev',\r\n                // The class for the \"next\" control:\r\n                next: '.next',\r\n                // The class for the \"close\" control:\r\n                close: '.close',\r\n                // The class for the \"play-pause\" toggle control:\r\n                cycleStop: '.cycle-stop'\r\n              }\r\n            },\r\n\r\n            indicators : {\r\n                indicator : {\r\n                  template : \"<li/>\",\r\n                  indexAttrName : \"data-index\"\r\n                },\r\n\r\n            },\r\n\r\n            selectors :{\r\n              itemsContainer : \".items\",\r\n              indicatorsContainer : \".indicators\"\r\n            },\r\n\r\n            item : {\r\n              selector : \".item\",\r\n              classes : {\r\n                base : \"item\"\r\n              }\r\n            },\r\n\r\n            data : {\r\n              //items : \".carousel-item\",  // the items are from dom elements\r\n              //items : [{                 // the items are from json object\r\n              //  type: 'image',href : \"https://xxx.com/1.jpg\",title : \"1\"\r\n              //},{\r\n              //  type: 'image',href : \"https://xxx.com/1.jpg\",title : \"1\"\r\n              // }],\r\n            },\r\n\r\n            effect : \"slide\",\r\n\r\n            startIndex : 0,\r\n\r\n            effects : {\r\n              slide : {\r\n                classes : {\r\n                  base : \"slide\"\r\n                }\r\n              },\r\n\r\n              rotate : {\r\n                classes : {\r\n                  base : \"rotate\"\r\n                }\r\n              },\r\n\r\n              coverflow : {\r\n                classes : {\r\n                  base : \"coverflow\"\r\n                }\r\n              }\r\n            },\r\n\r\n            onjumped : null,\r\n            onjumping : null\r\n        },\r\n\r\n        _construct: function(elm, options) {\r\n            //this.options = options\r\n            Group.prototype._construct.call(this,elm,options);\r\n\r\n            this.options.item.selectable = true;\r\n            this.options.item.multiSelect = false;\r\n\r\n\r\n            this._$elm = this.$();\r\n            this._$itemsContainer = this._$elm.find(this.options.selectors.itemsContainer);\r\n            \r\n            let $indicators = this._$elm.find(this.options.selectors.indicatorsContainer); \r\n            if ($indicators.length>0) {\r\n              this._indicators = new Indicators($indicators[0],langx.mixin({\r\n                carousel : this,\r\n                active : 0\r\n              },this.options.indicators));\r\n              this._indicators.setActiveIndicator(0);\r\n            }\r\n\r\n\r\n\r\n            this.paused = null;\r\n            this.moving = null;\r\n            this.interval = null;\r\n            this.$active = null;\r\n\r\n            if (this.options.cycle.interval >0) {\r\n              this.cycle(true);\r\n            } else {\r\n              this.cycle(false);\r\n            }\r\n\r\n            var self = this;\r\n            this.options.keyboard && this._$elm.on('keydown.lark.carousel', langx.proxy(this.keydown, this))\r\n\r\n            this.options.cycle.pause == 'hover' && !('ontouchstart' in document.documentElement) && this._$elm\r\n                .on('mouseenter.lark.carousel', (e) => {\r\n                  this.pause(true);\r\n                }).on('mouseleave.lark.carousel', (e) => {\r\n                  this.pause(false)\r\n                });\r\n\r\n            this._$elm.find(this.options.controls.selectors.prev).on(\"click\",(e)=>{\r\n                this.prev();\r\n                eventer.stop(e);\r\n            });\r\n\r\n            this._$elm.find(this.options.controls.selectors.next).on(\"click\",(e)=>{\r\n                this.next();\r\n                eventer.stop(e);\r\n            });\r\n\r\n            this._$elm.find(this.options.controls.selectors.cycleStop).on(\"click\",(e)=>{\r\n                this.cycle(!this.cycled);\r\n                eventer.stop(e);\r\n            });\r\n\r\n            this._effect = new effects[this.options.effect](this);\r\n\r\n            if (this.options.data.items) {\r\n                this.addItems(this.options.data.items);\r\n                this.jump(this.options.startIndex)\r\n            }\r\n\r\n            if (this.options.onjumped) {\r\n              this.on(\"jumped\",this.options.onjumped)\r\n            }\r\n\r\n            if (this.options.onjumping) {\r\n              this.on(\"jumping\",this.options.onjumping)\r\n            }\r\n        },\r\n\r\n        keydown : function(e) {\r\n            if (/input|textarea/i.test(e.target.tagName)) return\r\n            switch (e.which) {\r\n                case 37:\r\n                    this.prev();\r\n                    break\r\n                case 39:\r\n                    this.next();\r\n                    break\r\n                default:\r\n                    return\r\n            }\r\n\r\n            e.preventDefault()\r\n        },\r\n\r\n\r\n        /*\r\n         * Cycles through the carousel items from left to right.\r\n         */\r\n        cycle : function(cycling) {\r\n            if (langx.isDefined(cycling)) {\r\n              this.cycled = !!cycling;\r\n             ///  e || (this.paused = false)\r\n              if (this.cycled) {\r\n                 this._velm.addClass(this.options.classes.cycling)\r\n              } else {\r\n                 this._velm.removeClass(this.options.classes.cycling)\r\n              }\r\n            } \r\n\r\n            if (this.interval){\r\n              clearInterval(this.interval);\r\n            }\r\n\r\n            if (this.options.cycle.interval && this.cycled && !this.paused ) {\r\n                this.interval = setInterval(langx.proxy(this.next, this), this.options.cycle.interval);\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n\r\n        getItemForDirection : function(direction, active) {\r\n            var activeIndex = this.getItemIndex(active)\r\n            var willWrap = (direction == 'prev' && activeIndex === 0) ||\r\n                (direction == 'next' && activeIndex == (this._$items.length - 1))\r\n            if (willWrap && !this.options.wrap) return active\r\n            var delta = direction == 'prev' ? -1 : 1\r\n            var itemIndex = (activeIndex + delta) % this._$items.length\r\n            return this._$items.eq(itemIndex);\r\n        },\r\n\r\n        /*\r\n         *Cycles the carousel to a particular frame (0 based, similar to an array). Returns to the caller before the target item has been shown\r\n         */\r\n        jump : function(pos) {\r\n            var that = this;\r\n\r\n            var activeItem = this.getActiveItem(),\r\n                activeIndex = activeItem ? this.getItemIndex(activeItem) : -1;\r\n\r\n            if (pos > (this._$items.length - 1) || pos < 0) return\r\n\r\n            if (this.moving) return this._$elm.one('jumped.lark.carousel', function() { that.jump(pos) }) // yes, \"slid\"\r\n            if (activeIndex == pos)  return this.pause().cycle()\r\n\r\n            return this._effect.jump(pos > activeIndex ? 'next' : 'prev', this._$items.eq(pos))\r\n        },\r\n\r\n        /*\r\n         * Stops the carousel from cycling through items.\r\n         */\r\n        pause : function(pausing) {\r\n            if (langx.isUndefined(pausing)) {\r\n              pausing = true;\r\n            }\r\n            this.paused = !!pausing;\r\n\r\n            ///e || (this.paused = true)\r\n\r\n            ///if (this._$elm.find(this.options.controls.selectors.next + \",\"+ this.options.controls.selectors.prev).length) { //.next,.prev\r\n                ///this._$elm.trigger(browser.support.transition.end)\r\n                ///this.cycle(true)\r\n            ///}\r\n\r\n            ///this.interval = clearInterval(this.interval)\r\n            this.cycle();\r\n\r\n            return this\r\n        },\r\n\r\n        /*\r\n         * Cycles to the next item. Returns to the caller before the next item has been shown\r\n         */\r\n        next : function() {\r\n            if (this.moving) {\r\n              return\r\n            }\r\n            return this._effect.jump('next')\r\n        },\r\n\r\n        /*\r\n         * Cycles to the previous item. Returns to the caller before the previous item has been shown.\r\n         */\r\n        prev : function() {\r\n           if (this.moving) return\r\n            return this._effect.jump('prev')\r\n        },\r\n\r\n\r\n        addItems : function(items) {\r\n            let index = this.getItemsCount();\r\n            for (var i=0; i<items.length;i++) {\r\n              this.addItem(index++,items[i]);\r\n            }\r\n            this.resetItems();\r\n        },\r\n\r\n        addItem : function(index,itemData) {\r\n          let itemHtml = this.renderItemHtml(itemData),\r\n              baseClass = this.options.item.classes.base;\r\n\r\n\r\n          let $item = $(itemHtml);\r\n          if (baseClass) {\r\n            $item.addClass(baseClass);\r\n          }\r\n\r\n          if (this._$itemsContainer) {\r\n            this._$itemsContainer.append($item);\r\n          }\r\n          if (this._indicators) {\r\n            this._indicators.addIndicator(index,itemData);\r\n          }\r\n\r\n        }\r\n  });\r\n\r\n\r\n  plugins.register(Carousel);\r\n\r\n  return groups.Carousel = Carousel;\t\r\n});"]}