{"version":3,"sources":["_carousel/mode-coverflow.js"],"names":["define","langx","events","$","Emitter","inherit","_construct","carsouel","this","_itemOffsets","_currentIndex","classes","options","modes","coverflow","_classRemover","RegExp","itemCurrent","itemPast","itemFuture","_whiteSpaceRemover","reset","skipTransition","$itemsContainer","_$itemsContainer","$items","getItems","spacing","css","containerWidth","width","itemHeight","biggestHeight","height","each","i","item","left","$item","attr","c","replace","outerWidth","position","children","itemContent","length","wrapInner","center","setTimeout","currentIndex","undefined","newClass","zIndex","total","jump","toIndex","type","ended","one","emulateTransitionEnd"],"mappings":"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","file":"../../_carousel/mode-coverflow.js","sourcesContent":[" define([\r\n  \"skylark-langx/langx\",\r\n  \"skylark-langx-events\",\r\n  \"skylark-domx-query\",\r\n],function(langx,events,$){\r\n  'use strict'\r\n\r\n\r\n  var ModeCoverflow = events.Emitter.inherit({\r\n\r\n\r\n    _construct : function(carsouel) {\r\n    \tthis.carsouel = carsouel;\r\n\r\n    \tthis._itemOffsets = [];\r\n    \tthis._currentIndex = -1;\r\n\r\n    \tlet classes = this.carsouel.options.modes.coverflow.classes;\r\n\r\n        this._classRemover = new RegExp('\\\\b(' + classes.itemCurrent + '|' + classes.itemPast + '|' + classes.itemFuture + ')(.*?)(\\\\s|$)', 'g');\r\n        this._whiteSpaceRemover = new RegExp('\\\\s\\\\s+', 'g');\r\n\r\n    \tthis.reset();\r\n    },\r\n\r\n\r\n\r\n\r\n    reset : function (skipTransition) {\r\n    \tlet classes = this.carsouel.options.modes.coverflow.classes,\r\n    \t\t$itemsContainer = this.carsouel._$itemsContainer,\r\n    \t\t$items = this.carsouel.getItems(),\r\n    \t\tspacing = this.carsouel.options.modes.coverflow.spacing;\r\n\r\n\r\n\r\n        function noTransition() {\r\n            $itemsContainer.css('transition', 'none');\r\n            $items.css('transition', 'none');\r\n        }\r\n\r\n        function resetTransition() {\r\n            $itemsContainer.css('transition', '');\r\n            $items.css('transition', '');\r\n        }\r\n\r\n\t    function calculateBiggestItemHeight() {\r\n\t        var biggestHeight = 0,\r\n\t            itemHeight;\r\n\r\n\t        $items.each(function() {\r\n\t            itemHeight = $(this).height();\r\n\t            if ( itemHeight > biggestHeight ) { biggestHeight = itemHeight; }\r\n\t        });\r\n\t        return biggestHeight;\r\n\t    }\r\n\r\n        if ( skipTransition ) { \r\n        \tnoTransition(); \r\n        }\r\n\r\n        this._itemOffsets = [];\r\n\r\n        let containerWidth = $itemsContainer.width();\r\n        $itemsContainer.height(calculateBiggestItemHeight());\r\n\r\n        $items.each((i,item) => {\r\n            var $item = $(item),\r\n                width,\r\n                left;\r\n\r\n            $item.attr('class', function(i, c) {\r\n                return c && c.replace(this._classRemover, '').replace(this._whiteSpaceRemover, ' ');\r\n            });\r\n\r\n            width = $item.outerWidth();\r\n\r\n            if ( spacing !== 0 ) {\r\n                $item.css('margin-right', ( width * spacing ) + 'px');\r\n            }\r\n\r\n            left = $item.position().left;\r\n            this._itemOffsets[i] = -1 * ((left + (width / 2)) - (containerWidth / 2));\r\n\r\n            if ( !$item.children('.' + classes.itemContent ).length) {\r\n                $item.wrapInner('<div class=\"' + classes.itemContent + '\" />');\r\n            }\r\n        });\r\n\r\n        if (this._currentIndex>=0) {\r\n\t        this.center();\r\n        }\r\n        if ( skipTransition ) { \r\n        \tsetTimeout(resetTransition, 1); \r\n        }\r\n    },\r\n\r\n    center : function (currentIndex) {\r\n    \tif (currentIndex !== undefined) {\r\n\t        this._currentIndex = currentIndex;\r\n    \t} else {\r\n    \t\tcurrentIndex = this._currentIndex;\r\n    \t}\r\n    \tif (currentIndex>=0)  {\r\n\t        var classes = this.carsouel.options.modes.coverflow.classes,\r\n\t        \t$itemsContainer = this.carsouel._$itemsContainer,\r\n\t        \t$items =  this.carsouel.getItems(),\r\n\t        \ttotal = $items.length;\r\n\t        var $item;\r\n\t        var newClass;\r\n\t        var zIndex;\r\n\r\n\t        $items.each((i,item) => {\r\n\t            $item = $(item);\r\n\t            newClass = ' ';\r\n\r\n\t            if (i === currentIndex)  {\r\n\t                newClass += classes.itemCurrent;\r\n\t                zIndex = (total + 1);\r\n\t            }\r\n\t            else if (i < currentIndex) {\r\n\t                newClass += classes.itemPast + ' ' +\r\n\t                    classes.itemPast + '-' + (currentIndex - i);\r\n\t                zIndex = total - (currentIndex - i);\r\n\t            } else  {\r\n\t                newClass += classes.itemFuture + ' ' +\r\n\t                    classes.itemFuture + '-' + (i - currentIndex);\r\n\t                \r\n\t                zIndex = total -  (i - currentIndex);\r\n\t            }\r\n\r\n\t            $item.css('z-index', zIndex )\r\n\t              .attr('class',(i, c) => {\r\n\t                return c && c.replace(this._classRemover, '').replace(this._whiteSpaceRemover,' ') + newClass;\r\n\t              });\r\n\t        });\r\n\r\n\t        $itemsContainer.css('transform', 'translateX(' + this._itemOffsets[currentIndex] + 'px)');\r\n    \t}\r\n    },\r\n\r\n    jump : function(toIndex,currentIndex,type,ended) {\r\n        var $itemsContainer = this.carsouel._$itemsContainer;\r\n        this.center(toIndex);\r\n        $itemsContainer\r\n            .one('transitionEnd', function() {\r\n                ended();\r\n            })\r\n            .emulateTransitionEnd();\r\n\r\n        return this;\r\n    }\r\n\r\n  });\r\n\r\n\r\n  return ModeCoverflow;\t\r\n});"]}