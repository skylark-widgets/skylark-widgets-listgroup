{"version":3,"sources":["_carousel/mode-rotate.js"],"names":["define","langx","events","eventer","$","styler","Rotatable","Scalable","Emitter","inherit","options","_construct","carsouel","this","reset","_$threedContainer","modes","rotate","classes","threedContainer","_rotatable","started","stopped","_scalable","radius","targets","getItems","_start","delayTime","items","itemsCount","_itemsCount","length","deltaDeg","_deltaDeg","i","css","transform","jump","type","next","elmx","$active","getActiveItem","$next","getItemForDirection","direction","interval","hasClass","moving","nextIndex","getItemIndex","relatedTarget","movingEvent","create","trigger","isDefaultPrevented","_indicators","setActiveIndicator","movedEvent","addClass","reflow","_$itemsContainer","one","removeClass","join","setTimeout","emulateTransitionEnd"],"mappings":";;;;;;;AAACA,QACC,sBACA,uBACA,uBACA,qBACA,sBACA,0CACA,0CACA,SAASC,EAAMC,EAAOC,EAAQC,EAAEC,EAAOC,EAAUC,GACjD,aA2HA,OAxHiBL,EAAOM,QAAQC,SAE/BC,WAKCC,WAAa,SAASC,GACrBC,KAAKD,SAAWA,EAEhBC,KAAKC,QAEFD,KAAKE,kBAAoBH,EAASR,MAAMQ,EAASF,QAAQM,MAAMC,OAAOC,QAAQC,mBAEjFN,KAAKO,WAAa,IAAId,EAAUO,KAAKE,kBAAkB,IACpDM,QAAU,aAIVC,QAAU,eAKbT,KAAKU,UAAY,IAAIhB,EAASM,KAAKE,kBAAkB,IACpDS,OAASZ,EAASF,QAAQM,MAAMC,OAAOO,OACvCC,QAAUb,EAASc,aAGpBb,KAAKc,OAAS,GAIfb,MAAQ,SAASc,GAChB,IAAIC,EAAQhB,KAAKD,SAASc,WAC1B,GAAIG,EAAO,CACV,IAAIC,EAAajB,KAAKkB,YAAcF,EAAMG,OACzCC,EAAWpB,KAAKqB,UAAY,IAAMJ,EAEnC,IAAK,IAAIK,EAAI,EAAGA,EAAIL,EAAYK,IAC/B9B,EAAO+B,IAAIP,EAAMM,IAChBE,UAAY,WAAcF,EAAIF,EAAY,WAQ9CK,KAAO,SAASC,EAAMC,GACrB,IAAI5B,EAAWC,KAAKD,SACZA,EAAS6B,OACN7B,EAASF,QAEjB,IAAIgC,EAAW9B,EAASR,EAAEQ,EAAS+B,iBAClCC,EAAQJ,GAAQ5B,EAASiC,oBAAoBN,EAAMG,GAEnDI,GADYlC,EAASmC,SACD,QAARR,EAAiB,OAAS,SAEvC,GAAIK,EAAMI,SAAS,UAClB,OAAQpC,EAASqC,QAAS,EAG3B,IAAIC,EAAYtC,EAASuC,aAAaP,GAEtC,IAAIQ,EAAgBR,EAAM,GAEtBS,EAAclD,EAAQmD,OAAO,yBAC7BF,cAAeA,EACfN,UAAWA,IAIf,GADAlC,EAAS2C,QAAQF,GACbA,EAAYG,qBAAsB,OAEtC5C,EAASqC,QAAS,EAWdrC,EAAS6C,aACT7C,EAAS6C,YAAYC,mBAAmBR,GAG5C,IAAIS,EAAaxD,EAAQmD,OAAO,wBAA0BF,cAAeA,EAAeN,UAAWA,IAuBnG,OArBAF,EAAMgB,SAASrB,GACfK,EAAMiB,SACNnB,EAAQkB,SAASd,GACjBF,EAAMgB,SAASd,GAEOlC,EAASkD,iBAG1BC,IAAI,gBAAiB,WAClBnB,EAAMoB,aAAazB,EAAMO,GAAWmB,KAAK,MAAML,SAAS,UACxDlB,EAAQsB,aAAa,SAAUlB,GAAWmB,KAAK,MAC/CrD,EAASqC,QAAS,EAClBiB,WAAW,WACPtD,EAAS2C,QAAQI,IAClB,KAENvB,IAAI,YAAY,WAAcc,EAAYrC,KAAKqB,UAAa,QAC5DiC,uBAIEtD","file":"../../_carousel/mode-rotate.js","sourcesContent":[" define([\r\n  \"skylark-langx/langx\",\r\n  \"skylark-langx-events\",\r\n  \"skylark-domx-eventer\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-domx-styler\",\r\n  \"skylark-domx-plugins-interact/rotatable\",\r\n  \"skylark-domx-plugins-interact/scalable\"\r\n],function(langx,events,eventer,$,styler,Rotatable,Scalable){\r\n  'use strict'\r\n\r\n\r\n  var ModeRotate = events.Emitter.inherit({\r\n\r\n  \toptions : {\r\n\r\n  \t},\r\n\r\n\r\n    _construct : function(carsouel) {\r\n    \tthis.carsouel = carsouel;\r\n\r\n    \tthis.reset();\r\n\r\n        this._$threedContainer = carsouel.$(`.${carsouel.options.modes.rotate.classes.threedContainer}`)\r\n\r\n    \tthis._rotatable = new Rotatable(this._$threedContainer[0],{\r\n\t\t      started : function() {\r\n\t\t          //playSpin(false);\r\n\t\t      },\r\n\r\n\t\t      stopped : function() {\r\n\t\t          //playSpin(true);\r\n\t\t      }\r\n    \t});\r\n\r\n    \tthis._scalable = new Scalable(this._$threedContainer[0],{\r\n    \t\tradius : carsouel.options.modes.rotate.radius,\r\n    \t\ttargets : carsouel.getItems()\r\n    \t});\r\n\r\n    \tthis._start = 0;\r\n\r\n    },\r\n\r\n    reset : function(delayTime) {\r\n    \tlet items = this.carsouel.getItems();\r\n    \tif (items) {\r\n    \t\tlet itemsCount = this._itemsCount = items.length,\r\n    \t\t\tdeltaDeg = this._deltaDeg = 360 / itemsCount;\r\n\r\n\t\t    for (var i = 0; i < itemsCount; i++) {\r\n\t\t    \tstyler.css(items[i],{\r\n\t\t    \t\ttransform : \"rotateY(\" + (i * deltaDeg) + \"deg)\"\r\n\t\t    \t});\r\n\t\t    }    \t\t\r\n    \t}\r\n\r\n\r\n    },\r\n\r\n    jump : function(type, next) {\r\n    \tlet carsouel = this.carsouel,\r\n    \t\tvelm = carsouel.elmx(),\r\n    \t\toptions = carsouel.options\r\n\r\n        var $active =  carsouel.$(carsouel.getActiveItem()),\r\n        \t$next = next || carsouel.getItemForDirection(type, $active),\r\n        \tisCycling = carsouel.interval,\r\n        \tdirection = type == 'next' ? 'left' : 'right';\r\n\r\n        if ($next.hasClass('active')) {\r\n        \treturn (carsouel.moving = false)\r\n        }\r\n\r\n        let nextIndex = carsouel.getItemIndex($next);\r\n\r\n        var relatedTarget = $next[0];\r\n\r\n        var movingEvent = eventer.create('jumping.lark.carousel', {\r\n            relatedTarget: relatedTarget,\r\n            direction: direction\r\n        });\r\n\r\n        carsouel.trigger(movingEvent);\r\n        if (movingEvent.isDefaultPrevented()) return\r\n\r\n        carsouel.moving = true;\r\n\r\n        ///isCycling && carsouel.pause();\r\n\r\n        /*\r\n        if (this._$indicators.length) {\r\n            this._$indicators.find('.active').removeClass('active');\r\n            var $nextIndicator = $(this._$indicators.children()[this.getItemIndex($next)]);\r\n            $nextIndicator && $nextIndicator.addClass('active');\r\n        }\r\n        */\r\n        if (carsouel._indicators) {\r\n            carsouel._indicators.setActiveIndicator(nextIndex);\r\n        }\r\n\r\n        var movedEvent = eventer.create('jumped.lark.carousel', { relatedTarget: relatedTarget, direction: direction }) // yes, \"slid\"\r\n\r\n        $next.addClass(type);\r\n        $next.reflow(); // [0].offsetWidth; // force reflow\r\n        $active.addClass(direction);\r\n        $next.addClass(direction);\r\n\r\n        let $itemsContainer = carsouel._$itemsContainer;\r\n\r\n        $itemsContainer\r\n            .one('transitionEnd', function() {\r\n                $next.removeClass([type, direction].join(' ')).addClass('active')\r\n                $active.removeClass(['active', direction].join(' '))\r\n                carsouel.moving = false\r\n                setTimeout(function() {\r\n                    carsouel.trigger(movedEvent)\r\n                }, 0)\r\n            })\r\n            .css(\"transform\",\"rotateY(\" + (nextIndex * this._deltaDeg) + \"deg)\")\r\n            .emulateTransitionEnd();\r\n\r\n        //isCycling && carsouel.cycle();\r\n\r\n        return this\r\n    }\r\n\r\n\r\n  });\r\n\r\n\r\n  return ModeRotate;\t\r\n});"]}